<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <title>Esercizio 1</title>
</head>

<body>
    <div class="container">
        <h1>Contatti</h1>
        <div id="loading" class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md font-weight-bold">Nome</div>
                <div class="col-md font-weight-bold">Cognome</div>
                <div class="col-md font-weight-bold">Telefono</div>
                <div class="col-md font-weight-bold">Email</div>
                <div class="col-md font-weight-bold">Rimuovi contatto</div>
            </div>
            <span id="tabella-body">
            </span>
        </div>
    </div>

    <div class="container mt-3 mb-3">
        <button class="btn btn-primary" id="btnCreaContatto">Crea nuovo contatto</button>
    </div>

    <div id="creaNuovoContatto" class="d-none">
        <div class="container">
            <h1>FORM - Nuovo Contatto</h1>
        </div>
        <div class="container">
            <div id="risultato"></div>
        </div>
        <div class="container mt-3">
            <form id="formContatto">
                <div class="form-group row">
                    <label for="nome" class="col-sm-2 col-form-label">Nome:</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="nome" placeholder="Inserisci il nome">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="cognome" class="col-sm-2 col-form-label">Cognome:</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="cognome" placeholder="Inserisci il cognome">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="telefono" class="col-sm-2 col-form-label">Telefono:</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="telefono" placeholder="Inserisci il telefono">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="email" class="col-sm-2 col-form-label">Email:</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="email" placeholder="Inserisci un indirizzo email">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Aggiungi Contatto</button>
            </form>
        </div>
    </div>
    <script src="./es_rubrica.js"></script>
    <script>
        let rubricaManager = new Rubrica();

        rubricaManager.inserisciNuovoContatto(new Contatto("Giulio", "Rossi", "31273216376217", "r.g@hotmail.it"));

        rubricaManager.stampaContatti();

        let btnCreaContatto = document.getElementById("btnCreaContatto");
        btnCreaContatto.addEventListener("click", function (e) {
            let creaForm = document.getElementById("creaNuovoContatto");
            creaForm.className = "";
        });

        let formContatto = document.getElementById("formContatto");
        formContatto.addEventListener("submit", function (event) {
            // console.log(event);
            let nome = document.getElementById("nome").value;
            let cognome = document.getElementById("cognome").value;
            let telefono = document.getElementById("telefono").value;
            let email = document.getElementById("email").value;

            let contatto = new Contatto(nome, cognome, telefono, email);

            if (!(validaCampo("nome")
                && validaCampo("cognome")
                && validaEmail("email"))) {
                alert("i dati inseriti non sono validi.");
            }else {
                rubricaManager.inserisciNuovoContatto(contatto);
                let formCont = document.getElementById("formContatto");
                formCont.reset();
                let creaForm = document.getElementById("creaNuovoContatto");
                creaForm.className = "d-none";
                rubricaManager.stampaContatti();  
            }

            event.preventDefault();

        })


        function validaCampo(id) {
            let inputText = document.getElementById(id);
            let value = inputText.value;
            if (value.length >= 3) {
                return true;
            }
        }

        function validaEmail(id) {
            let inputEmail = document.getElementById(id);
            let value = inputEmail.value.trim();
            if (value.indexOf("@") >= 0) {
                return true;
            }
            return false;
        }
    </script>
</body>

</html>